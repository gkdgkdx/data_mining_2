# 第二次互评作业

## main1：商品类别关联规则挖掘

### 功能简介
分析用户在同一订单中购买的不同商品**大类别**之间的关联关系，挖掘频繁项集和关联规则，特别关注“电子产品”与其他类别的关联。

### 输入数据
- **订单数据**：parquet 格式，需包含 `purchase_history` 字段。
- **商品目录**：JSON 格式，包含商品ID、类别（小类）、价格等。

### 主要流程
1. **数据读取**：只读取 `purchase_history` 列，支持分批处理和抽样。
2. **类别映射**：将商品小类映射为大类（如“智能手机”归为“电子产品”）。
3. **订单处理**：提取每个订单中所有商品的大类别，形成类别集合。
4. **频繁项集挖掘**：使用 Apriori 算法，找出支持度大于等于阈值的频繁类别组合。
5. **关联规则挖掘**：基于频繁项集，挖掘置信度大于等于阈值的关联规则。
6. **重点类别筛选**：筛选“电子产品”相关的规则。
7. **结果输出与可视化**：打印统计信息、频繁项集、所有规则和重点规则，生成支持度分布、规则散点图等可视化图片。
8. **结果保存**：将频繁项集、规则、重点规则、统计信息及可视化图片保存到 `./results` 目录。

### 应用场景
- 发现常被一起购买的商品大类组合
- 分析“电子产品”与其他品类的搭配销售机会
- 为商品推荐、组合促销等业务提供数据支持

---

## main2：支付方式与商品类别的关联分析

### 功能简介
挖掘不同支付方式与商品大类别之间的关联规则，并分析高价值商品（价格 > 5000元）的首选支付方式。

### 输入数据
- **订单数据**：parquet 格式，需包含 `purchase_history` 字段（含支付方式、商品ID、价格等）。
- **商品目录**：JSON 格式，包含商品ID、类别（小类）、价格等。

### 主要流程
1. **数据读取**：只读取 `purchase_history` 列，支持分批处理和抽样。
2. **类别映射**：将商品小类映射为大类。
3. **订单处理**：提取每个订单的支付方式和所有商品的大类别，形成“支付方式+类别”集合。
4. **高价值商品分析**：统计高价值商品（单价>5000元）订单的支付方式分布。
5. **关联规则挖掘**：对“支付方式+类别”集合进行 Apriori 频繁项集和关联规则挖掘。
6. **结果输出与可视化**：打印统计信息、支付方式分布、规则，生成支付方式分布柱状图、规则散点图等可视化图片。
7. **结果保存**：将规则、支付方式分布、统计信息及可视化图片保存到 `./results` 目录。

### 应用场景
- 了解不同商品大类的主流支付方式
- 分析高价商品用户的支付偏好
- 为支付渠道优化、促销活动设计等提供数据支持

---

## main3：时间序列模式挖掘

### 功能简介
分析用户购物行为的季节性、月度、周度模式，识别特定商品大类别在不同时间段的购买频率变化，并探索“先买A类后买B类”的时序模式。

### 输入数据
- **订单数据**：parquet 格式，需包含 `purchase_history` 字段（含购买日期、商品ID等）。
- **商品目录**：JSON 格式，包含商品ID、类别（小类）、价格等。

### 主要流程
1. **数据读取**：只读取 `purchase_history` 列，支持分批处理和抽样。
2. **类别映射**：将商品小类映射为大类。
3. **订单处理**：提取每个订单的购买日期和商品大类别。
4. **季节性/月份/周度分析**：统计各大类别在不同季度、月份、星期的购买频率（以比例展示）。
5. **类别时间特征**：分析各大类别的购买高峰月、周、平均购买间隔等。
6. **时序模式挖掘**：分析“先买A类后买B类”的序列关系（30天内）。
7. **结果输出与可视化**：打印各类时间模式、类别特征、时序模式，生成热力图、柱状图等可视化图片。
8. **结果保存**：将所有分析结果（JSON）、可视化图片保存到 `./results` 目录。

### 应用场景
- 发现商品大类的季节性销售规律
- 识别促销时机和主推品类
- 挖掘用户跨品类的时序购买习惯

---

## main4：退款模式分析

### 功能简介
挖掘与“已退款”或“部分退款”状态相关的商品大类别组合，分析导致退款的可能商品组合模式，并找出相关的关联规则。

### 输入数据
- **订单数据**：parquet 格式，需包含 `purchase_history` 字段（含支付状态、商品ID等）。
- **商品目录**：JSON 格式，包含商品ID、类别（小类）、价格等。

### 主要流程
1. **数据读取**：只读取 `purchase_history` 列，支持分批处理和抽样。
2. **类别映射**：将商品小类映射为大类。
3. **订单处理**：提取每个订单的退款状态和商品大类别。
4. **退款率统计**：统计各大类别的退款率、退款订单数、总订单数。
5. **退款组合分析**：对高频退款类别组合进行 Apriori 频繁项集和关联规则挖掘。
6. **结果输出与可视化**：打印退款率、各类别退款情况、退款组合规则，生成退款率分布、规则散点图、饼图等可视化图片。
7. **结果保存**：将规则、退款率、统计信息及可视化图片保存到 `./results` 目录。

### 应用场景
- 识别高退款风险的商品大类别及其组合
- 优化商品组合、提升售后服务
- 为风险预警、商品改进等提供数据支持

---